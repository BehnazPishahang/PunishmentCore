@page "/CaseFollowUpNo/{_CaseNo}"

@using Anu.PunishmentOrg.Client.Infrastructure.Contracts.PCase
@using Anu.PunishmentOrg.Client.Infrastructure.Pcase
@using Anu.PunishmentOrg.ServiceModel.Case
@using Anu.PunishmentOrg.Client


@inject IPCaseService _pCaseService
@inject AppConfiguration _appConfiguration;

<div class="jumbotron text-center border-info border-2 oi-header">
    <h3>پیگیری پرونده</h3>
</div>

<MudForm>
    <MudCard Style="margin-bottom:5px;">
        <MudCardContent>
            <MudText>شماره پرونده : @_CaseNo</MudText>
        </MudCardContent>
    </MudCard>
    <MudCard>
        <MudCardContent>
            <div class="row">
                <MudList>
                    @if (Elements != null)
                    {
                        @if (Elements.Result.Code == 1000)
                        {
                            @for (int i = 0; i < Elements.ExportInqueryPCaseContract.Cases.Count; i++)
                            {
                                @foreach (var item in Elements.ExportInqueryPCaseContract.Cases[i])
                                {
                                    <MudListItem Style="margin-right:20px" Icon="@Icons.Filled.FiberManualRecord" IconSize="Size.Small" IconColor="Color.Error">@item</MudListItem>
                                }
                            }
                        }
                    }
                </MudList>
            </div>
        </MudCardContent>
    </MudCard>
</MudForm>

@code {

    [Parameter]
    public string _CaseNo { get; set; }

    ExportInqueryPCaseResponse Elements;
    //

    protected override Task OnInitializedAsync()
    {
        GetCaseSummary();
        return base.OnInitializedAsync();
    }
    private async Task GetCaseSummary()
    {
        if (string.IsNullOrEmpty(_CaseNo) == false)
            Elements = await _pCaseService.ExportInqueryPCase(_appConfiguration.BackendServerAddress, _appConfiguration.ExportInqueryPCase, SharedInfo.NationalCode, _CaseNo, SharedInfo.AccessToken);
    }
}
